<!DOCTYPE html><html><head><title></title><link rel="stylesheet" href="../OpenApi.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/></head><body><article><section  class="requestOverview"><h1  class="requestSummary">GetInvoicesUpcoming</h1><p  class="requestDescription"><p>At any time, you can preview the upcoming invoice for a customer. This will show you all the charges that are pending, including subscription renewal charges, invoice item charges, etc. It will also show you any discounts that are applicable to the invoice.</p>

<p>Note that when you are viewing an upcoming invoice, you are simply viewing a preview – the invoice has not yet been created. As such, the upcoming invoice will not show up in invoice listing calls, and you cannot use the API to pay or edit the invoice. If you want to change the amount that your customer will be billed, you can add, remove, or update pending invoice items, or update the customer’s discount.</p>

<p>You can preview the effects of updating a subscription, including a preview of what proration will take place. To ensure that the actual proration is calculated exactly the same as the previewed proration, you should pass a <code>proration_date</code> parameter when doing the actual subscription update. The value passed in should be the same as the <code>subscription_proration_date</code> returned on the upcoming invoice resource. The recommended way to get only the prorations being previewed is to consider only proration line items where <code>period[start]</code> is equal to the <code>subscription_proration_date</code> on the upcoming invoice resource.</p></p></section><section  class="http"><h3>HTTP Request</h3><pre  class="httpExample"><span  class="requestLine">GET</span> <span  class="httpTarget">+{baseUrl}\v1\invoices\upcoming{?automatic_tax*,coupon*,currency*,customer*,customer_details*,discounts*,expand*,invoice_items*,schedule*,subscription*,subscription_billing_cycle_anchor*,subscription_cancel_at*,subscription_cancel_at_period_end*,subscription_cancel_now*,subscription_default_tax_rates*,subscription_items*,subscription_proration_behavior*,subscription_proration_date*,subscription_resume_at*,subscription_start_date*,subscription_trial_end*,subscription_trial_from_plan*}</span> <span  class="httpVersion">HTTP/1.1</span>
<span  class="headerLine">host</span>: <span  class="headerValue">example.org:443</span>
<span  class="headerLine">accept</span>: <span  class="headerValue">application/json</span>
</pre></section><dl  class="parameters"><h3>Parameters</h3><dt  class="parameter"><span  class="parameterName">automatic_tax</span> [ in: <span  class="parameterLocation">Query</span> type: <span  class="parameterType">object</span> ]</dt><dd  class="parameter"><span  class="parameterDescription">Settings for automatic tax lookup for this invoice preview.</span> <span  class="parameterRequired">optional</span></dd><dt  class="parameter"><span  class="parameterName">coupon</span> [ in: <span  class="parameterLocation">Query</span> type: <span  class="parameterType">string</span> ]</dt><dd  class="parameter"><span  class="parameterDescription">The code of the coupon to apply. If `subscription` or `subscription_items` is provided, the invoice returned will preview updating or creating a subscription with that coupon. Otherwise, it will preview applying that coupon to the customer for the next upcoming invoice from among the customer's subscriptions. The invoice can be previewed without a coupon by passing this value as an empty string.</span> <span  class="parameterRequired">optional</span></dd><dt  class="parameter"><span  class="parameterName">currency</span> [ in: <span  class="parameterLocation">Query</span> type: <span  class="parameterType">string</span> ]</dt><dd  class="parameter"><span  class="parameterDescription">The currency to preview this invoice in. Defaults to that of `customer` if not specified.</span> <span  class="parameterRequired">optional</span></dd><dt  class="parameter"><span  class="parameterName">customer</span> [ in: <span  class="parameterLocation">Query</span> type: <span  class="parameterType">string</span> ]</dt><dd  class="parameter"><span  class="parameterDescription">The identifier of the customer whose upcoming invoice you'd like to retrieve.</span> <span  class="parameterRequired">optional</span></dd><dt  class="parameter"><span  class="parameterName">customer_details</span> [ in: <span  class="parameterLocation">Query</span> type: <span  class="parameterType">object</span> ]</dt><dd  class="parameter"><span  class="parameterDescription">Details about the customer you want to invoice or overrides for an existing customer.</span> <span  class="parameterRequired">optional</span></dd><dt  class="parameter"><span  class="parameterName">discounts</span> [ in: <span  class="parameterLocation">Query</span> type: <span  class="parameterType"></span> ]</dt><dd  class="parameter"><span  class="parameterDescription">The coupons to redeem into discounts for the invoice preview. If not specified, inherits the discount from the customer or subscription. This only works for coupons directly applied to the invoice. To apply a coupon to a subscription, you must use the `coupon` parameter instead. Pass an empty string to avoid inheriting any discounts. To preview the upcoming invoice for a subscription that hasn't been created, use `coupon` instead.</span> <span  class="parameterRequired">optional</span></dd><dt  class="parameter"><span  class="parameterName">expand</span> [ in: <span  class="parameterLocation">Query</span> type: <span  class="parameterType">array</span> ]</dt><dd  class="parameter"><span  class="parameterDescription">Specifies which fields in the response should be expanded.</span> <span  class="parameterRequired">optional</span></dd><dt  class="parameter"><span  class="parameterName">invoice_items</span> [ in: <span  class="parameterLocation">Query</span> type: <span  class="parameterType">array</span> ]</dt><dd  class="parameter"><span  class="parameterDescription">List of invoice items to add or update in the upcoming invoice preview.</span> <span  class="parameterRequired">optional</span></dd><dt  class="parameter"><span  class="parameterName">schedule</span> [ in: <span  class="parameterLocation">Query</span> type: <span  class="parameterType">string</span> ]</dt><dd  class="parameter"><span  class="parameterDescription">The identifier of the unstarted schedule whose upcoming invoice you'd like to retrieve. Cannot be used with subscription or subscription fields.</span> <span  class="parameterRequired">optional</span></dd><dt  class="parameter"><span  class="parameterName">subscription</span> [ in: <span  class="parameterLocation">Query</span> type: <span  class="parameterType">string</span> ]</dt><dd  class="parameter"><span  class="parameterDescription">The identifier of the subscription for which you'd like to retrieve the upcoming invoice. If not provided, but a `subscription_items` is provided, you will preview creating a subscription with those items. If neither `subscription` nor `subscription_items` is provided, you will retrieve the next upcoming invoice from among the customer's subscriptions.</span> <span  class="parameterRequired">optional</span></dd><dt  class="parameter"><span  class="parameterName">subscription_billing_cycle_anchor</span> [ in: <span  class="parameterLocation">Query</span> type: <span  class="parameterType"></span> ]</dt><dd  class="parameter"><span  class="parameterDescription">For new subscriptions, a future timestamp to anchor the subscription's [billing cycle](https://stripe.com/docs/subscriptions/billing-cycle). This is used to determine the date of the first full invoice, and, for plans with `month` or `year` intervals, the day of the month for subsequent invoices. For existing subscriptions, the value can only be set to `now` or `unchanged`.</span> <span  class="parameterRequired">optional</span></dd><dt  class="parameter"><span  class="parameterName">subscription_cancel_at</span> [ in: <span  class="parameterLocation">Query</span> type: <span  class="parameterType"></span> ]</dt><dd  class="parameter"><span  class="parameterDescription">Timestamp indicating when the subscription should be scheduled to cancel. Will prorate if within the current period and prorations have been enabled using `proration_behavior`.</span> <span  class="parameterRequired">optional</span></dd><dt  class="parameter"><span  class="parameterName">subscription_cancel_at_period_end</span> [ in: <span  class="parameterLocation">Query</span> type: <span  class="parameterType">boolean</span> ]</dt><dd  class="parameter"><span  class="parameterDescription">Boolean indicating whether this subscription should cancel at the end of the current period.</span> <span  class="parameterRequired">optional</span></dd><dt  class="parameter"><span  class="parameterName">subscription_cancel_now</span> [ in: <span  class="parameterLocation">Query</span> type: <span  class="parameterType">boolean</span> ]</dt><dd  class="parameter"><span  class="parameterDescription">This simulates the subscription being canceled or expired immediately.</span> <span  class="parameterRequired">optional</span></dd><dt  class="parameter"><span  class="parameterName">subscription_default_tax_rates</span> [ in: <span  class="parameterLocation">Query</span> type: <span  class="parameterType"></span> ]</dt><dd  class="parameter"><span  class="parameterDescription">If provided, the invoice returned will preview updating or creating a subscription with these default tax rates. The default tax rates will apply to any line item that does not have `tax_rates` set.</span> <span  class="parameterRequired">optional</span></dd><dt  class="parameter"><span  class="parameterName">subscription_items</span> [ in: <span  class="parameterLocation">Query</span> type: <span  class="parameterType">array</span> ]</dt><dd  class="parameter"><span  class="parameterDescription">A list of up to 20 subscription items, each with an attached price.</span> <span  class="parameterRequired">optional</span></dd><dt  class="parameter"><span  class="parameterName">subscription_proration_behavior</span> [ in: <span  class="parameterLocation">Query</span> type: <span  class="parameterType">string</span> ]</dt><dd  class="parameter"><span  class="parameterDescription">Determines how to handle [prorations](https://stripe.com/docs/subscriptions/billing-cycle#prorations) when the billing cycle changes (e.g., when switching plans, resetting `billing_cycle_anchor=now`, or starting a trial), or if an item's `quantity` changes. The default value is `create_prorations`.</span> <span  class="parameterRequired">optional</span></dd><dt  class="parameter"><span  class="parameterName">subscription_proration_date</span> [ in: <span  class="parameterLocation">Query</span> type: <span  class="parameterType">integer</span> ]</dt><dd  class="parameter"><span  class="parameterDescription">If previewing an update to a subscription, and doing proration, `subscription_proration_date` forces the proration to be calculated as though the update was done at the specified time. The time given must be within the current subscription period and within the current phase of the schedule backing this subscription, if the schedule exists. If set, `subscription`, and one of `subscription_items`, or `subscription_trial_end` are required. Also, `subscription_proration_behavior` cannot be set to 'none'.</span> <span  class="parameterRequired">optional</span></dd><dt  class="parameter"><span  class="parameterName">subscription_resume_at</span> [ in: <span  class="parameterLocation">Query</span> type: <span  class="parameterType">string</span> ]</dt><dd  class="parameter"><span  class="parameterDescription">For paused subscriptions, setting `subscription_resume_at` to `now` will preview the invoice that will be generated if the subscription is resumed.</span> <span  class="parameterRequired">optional</span></dd><dt  class="parameter"><span  class="parameterName">subscription_start_date</span> [ in: <span  class="parameterLocation">Query</span> type: <span  class="parameterType">integer</span> ]</dt><dd  class="parameter"><span  class="parameterDescription">Date a subscription is intended to start (can be future or past)</span> <span  class="parameterRequired">optional</span></dd><dt  class="parameter"><span  class="parameterName">subscription_trial_end</span> [ in: <span  class="parameterLocation">Query</span> type: <span  class="parameterType"></span> ]</dt><dd  class="parameter"><span  class="parameterDescription">If provided, the invoice returned will preview updating or creating a subscription with that trial end. If set, one of `subscription_items` or `subscription` is required.</span> <span  class="parameterRequired">optional</span></dd><dt  class="parameter"><span  class="parameterName">subscription_trial_from_plan</span> [ in: <span  class="parameterLocation">Query</span> type: <span  class="parameterType">boolean</span> ]</dt><dd  class="parameter"><span  class="parameterDescription">Indicates if a plan's `trial_period_days` should be applied to the subscription. Setting `subscription_trial_end` per subscription is preferred, and this defaults to `false`. Setting this flag to `true` together with `subscription_trial_end` is not allowed. See [Using trial periods on subscriptions](https://stripe.com/docs/billing/subscriptions/trials) to learn more.</span> <span  class="parameterRequired">optional</span></dd></dl><section  class="requestContent"><h3>Request Body Schema</h3><pre  class="schema"></pre></section><section  class="responses"><h2>Responses</h2><ul  class="responses"><li  class="response"><span  class="statusLine">200</span> <span  class="statusDescription">Successful response.</span></li><li  class="response"><span  class="statusLine">default</span> <span  class="statusDescription">Error response.</span></li></ul></section></article></body></html>